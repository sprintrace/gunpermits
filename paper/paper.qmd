---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Another author
thanks: "Code and data are available at: LINK."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
execute:
  echo: FALSE 
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)

```


```{r}
chooseCRANmirror(graphics = FALSE)  # Select a CRAN mirror
install.packages("devtools")        # Install the devtools package
```


```{r}
install.packages("devtools")
install.packages("kableExtra")
devtools::install_github("haozhu233/kableExtra")
```



```{r}
library(knitr)
library(kableExtra)

library(knitr)
library(kableExtra)

# Define the list
dflist <- list(variables = c("All Americans","Race", "Gender", "Political Affiliation", "Level of Education"),
               observations = c("All the following groups", "Self identified race of participants","Male/Female","Democrat/Republican/Other", "College Degree or Higher/Highschool Diploma/ No Highschool Diploma")
              ) 

# Convert the list to a data frame
df <- as.data.frame(dflist)

# Transpose the data frame
df <- t(df)

# Display the transposed data frame as a table with kableExtra
kbl(df) %>%
  kable_classic(full_width = FALSE, html_font = "Cambria")

##///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

# Define the additional rows
additional_rows <- data.frame(variables = c("Banchod"),
                              observations = c("Banchod")
                             )

# Combine the original data frame with the additional rows

# Transpose the data frame
df <- t(df)

# Display the updated data frame as a table with kableExtra
kbl(df) %>%
  kable_classic(full_width = FALSE, html_font = "Cambria")


```




# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

//sum up gen survey and the questions the survey is intended to ask.
Background about the GSS. 

Background about the sampling methodology

Background about the questions that are asked.

Plot each variable of interest and add discussion around them.


Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)


Talk way more about it. 



# Results

Our results are summarized in.

//Add some analysis here. So that might be looking at difference over time or between states or between genders. Whatever.

When looking at a general overview regarding sentiment towards mandatory gun permits for firearm owners in the United States, it's clear that in more recent years there has been less support for citizens having permits. Support for mandatory gun permits increased under the Reagan Republican administration. Support for mandatory gun permits started to decrease around the time of 2001/02. From 2002 onward sentiment toward mandatory gun permits has steadily decreased regardless of which party controlled the White House. Even during the Democratic party’s Obama administration  support for mandatory gun permits decreased.

//Graph of the total//
```{r,echo=FALSE, results=FALSE}
#| echo: false
#| warning: false
#| message: false

# Plot 1: GGPlot for GunLaw
Gunlaw <- read_csv(here("./data/analysis_data/Gunlaw.csv"))
transform(Gunlaw, 'Total Americans in Favour' = as.numeric('Total Americans in Favour')) 

names(Gunlaw) <- c("Year", "Total")

ggplot(data=Gunlaw, aes(x = Year, y = Total, group = 1)) +
  geom_line()+
  labs(title = "Percentage of Americans in favour of police backed gun permits", y = "Total % of Americans in favour")

```


Looking at how sentiments differ between Republicans and Democrats is also noteworthy. The second term of the George W. Bush Administration in 2004 Is notable as the starting  point for when sentiments towards mandatory gun permit ownership became more polarizing. While the views of voting Democrats remain pretty consistent, the views of Republicans start to differ going forward into the following administrations from where they were under the previous Clinton administration. Before the George W Bush administration, sentiments differed, but were similar between both Republican- and Democrat-voting Americans. 

//Graph of DEMS VS REPUBLICANS//

```{r,echo=FALSE, results=FALSE}
#| echo: false
#| warning: false
#| message: false  

## load in CSV ##


# Plot 1: GGPlot for GunLaw
GunlawRepVsDem.csv <- read_csv(here("./data/analysis_data/GunlawRepVsDem.csv"))
transform(GunlawRepVsDem.csv, 'Total Americans in Favour' = as.numeric('Total Americans in Favour')) 

## create ggplot ##

### turn strings into numbers
transform(GunlawRepVsDem.csv, 'Democrats' = as.numeric('Democrats')) 
transform(GunlawRepVsDem.csv, 'Republicans' = as.numeric('Republicans')) 
transform(GunlawRepVsDem.csv, 'Other/Non-affiliated' = as.numeric('Other/Non-affiliated')) 


####Make 2 columns side by side into two values in one column one above the other (turn data into long format)
GunlawRepVsDem.csv <- GunlawRepVsDem.csv |> 
  pivot_longer(cols=c('Democrats', 'Republicans', 'Other/Non-affiliated'), names_to='Party', values_to='Total')
###### MAKE THE PLOT #######
ggplot(data=GunlawRepVsDem.csv, aes(x = Year, y=Total, group = Party)) +
  geom_line(aes(colour=Party))+
  labs(title = "Americans in favour of police backed gun permits \n based on political affiliation", y = "Total % in favour")




```

Additionally worth note is how sentiments towards gun permits change depending on Americans’ level of Education. Those with a college degree or higher overall have greater support towards gun owners having a permit, followed by Americans without high school diplomas. The lowest support for gun owners requiring permits comes from Americans that have a high school diploma and no college degree. 

//Graph of Education level and opinions for gun permits
```{r,echo=FALSE, results=FALSE}
#| echo: false
#| warning: false
#| message: false   
#3    GGPlot for GunlawHighestDegree

## load in CSV ##
GunlawHighestDegree.csv <- read_csv(here("./data/analysis_data/GunlawHighestDegree.csv"))
transform(GunlawHighestDegree.csv, 'Total Americans in Favour' = as.numeric('Total Americans in Favour')) 

## create ggplot ##

### turn strings into numbers
transform(GunlawHighestDegree.csv, 'Degree or Higher' = as.numeric('Degree or Higher')) 
transform(GunlawHighestDegree.csv, 'Highschool' = as.numeric('Highschool')) 
transform(GunlawHighestDegree.csv, 'No Highschool' = as.numeric('No Highschool')) 


####Make 2 columns side by side into two values in one column one above the other (turn data into long format)
GunlawHighestDegree.csv <- GunlawHighestDegree.csv |> 
  pivot_longer(cols=c('Degree or Higher', 'Highschool', 'No Highschool'), names_to='Education', values_to='Total')
###### MAKE THE PLOT #######
ggplot(data=GunlawHighestDegree.csv, aes(x = Year, y=Total, group = Education)) +
  geom_line(aes(colour=Education))+
  labs(title = "Percentage of Americans in favour of police \n backed gun permits based on higest level of education", y = "Total % in favour")



```

We can also observe a large difference between male and female opinions on gun permits, where there is a consistent 15-20% difference towards mandatory enforcement of gun permits. 

//Graph of MaleVsFemale
```{r,echo=FALSE, results=FALSE}
#| echo: false
#| warning: false
#| message: false   
#2    GGPlot for GenderAndGunPermit
## load in CSV ##
GenderAndGunPermit.csv <- read_csv(here("./data/analysis_data/GenderAndGunPermit.csv"))
transform(GenderAndGunPermit.csv, 'Total Americans in Favour' = as.numeric('Total Americans in Favour')) 

## create ggplot ##

### turn strings into numbers
transform(GenderAndGunPermit.csv, 'Female' = as.numeric('Female')) 
transform(GenderAndGunPermit.csv, 'Male' = as.numeric('Male')) 

####Make 2 columns side by side into two values in one column one above the other (turn data into long format)
GenderAndGunPermit.csv <- GenderAndGunPermit.csv |> 
  pivot_longer(cols=c('Female', 'Male'), names_to='Gender', values_to='Total')
###### MAKE THE PLOT #######
ggplot(data=GenderAndGunPermit.csv, aes(x = Year, y=Total, group = Gender)) +
  geom_line(aes(colour=Gender))+
  labs(title = "Percentage of American Women vs Men \n in favour of police backed gun permits", y = "Total % in favour")




```

Race also appears to interact with gun ownership sentiments. Almost consistently, white people are less in favour of police backed mandatory gun permits. However, the omission of other racial groups in favour of one group called “other” makes it difficult to get a sense for the true opinions of America based on race. By combining many groups into one, we can observe a very volatile line on the graph that jumps between extremes multiple times before 1989. This data collection choice makes interpretation and comprehension difficult. 

///Graph of Race and Gun Law
```{r,echo=FALSE, results=FALSE}
#| echo: false
#| warning: false
#| message: false  ## load in CSV ##

#5    GGPlot for RaceAndGunlaw

## load in CSV ##
RaceAndGunlaw.csv <- read_csv(here("./data/analysis_data/RaceAndGunlaw.csv"))
transform(RaceAndGunlaw.csv, 'Total Americans in Favour' = as.numeric('Total Americans in Favour')) 

## create ggplot ## 
 
### turn strings into numbers
transform(RaceAndGunlaw.csv, 'White' = as.numeric('White')) 
transform(RaceAndGunlaw.csv, 'Black' = as.numeric('Black')) 
transform(RaceAndGunlaw.csv, 'Other' = as.numeric('Other')) 
 

####Make 2 columns side by side into two values in one column one above the other (turn data into long format)
RaceAndGunlaw.csv <- RaceAndGunlaw.csv |> 
  pivot_longer(cols=c('White', 'Black', 'Other'), names_to='Race', values_to='Total')
###### MAKE THE PLOT #######
ggplot(data=RaceAndGunlaw.csv, aes(x = Year, y=Total, group = Race)) +
  geom_line(aes(colour=Race))+
  labs(title = "Americans in favour of police backed \n gun permits based on racial identity", y = "Total % in favour")


```


# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}



# References




